.tab {
  user-select: none;
  position: relative;
  display: flex;
  align-items: stretch;
  height: var(--block-height);
  background: var(--color-two);
  // background: transparent;
  color: var(--color-three);
  margin: 0 0 var(--lesser-padding) 0;
  padding: var(--greater-padding);
  // border-radius: var(--lesser-padding);
  --moved-offset: 0px;
  --filter-offset: 0px;
  --deleted-offset: 0px;
  --drag-offset: 0px;
  // --y-offset: 0px;
  --delay: 0;
  --trans-delay: 0ms;
  --opacity-delay: 0ms;
  --trans-duration: 0ms;
  --opacity-duration: 0ms;
  --misc-offset: 0;
  // --backdrop-filter: none;
  --backdrop-filter: none;
  // --animation-duration: 0ms;
  --opacity: 1;
  --x-pos: 17rem;
  --y-pos: 1rem;
  --animation-iteration-count: 0;
  // --scale: 0.99;
  --scale: 1;
  visibility: visible;
  touch-action: none;
  stroke: transparent;

  // transform: scale(1);
  backdrop-filter: var(--backdrop-filter);
  // transform: translateY(--filter-offset);
  transition: background-color 100ms ease-out;
  animation: returnToNormal 100ms ease-out var(--animation-iteration-count);
  // animation-fill-mode: unset;
  font-family: 'Open Sans', sans-serif;
  --special-z-index: 0;
  z-index: var(--special-z-index);

  // &::after {
  //   content: "";
  //   pointer-events: none;
  //   position: absolute;
  //   top: 0;
  //   left: 0;
  //   width: 100%;
  //   height: 100%;
  //   // z-index: -1;
  //   background: transparent;
  //   backdrop-filter: var(--backdrop-filter);
  // }


  &:hover {
    & .tab__tab-button {
      &::after {
        content: "";
        opacity: 1;
        transition: opacity 100ms ease-in;
      }
    }
  }

  &--filtered-out {
    pointer-events: none;
    visibility: hidden;
    opacity: 0;
    transform: translateY(var(--filter-offset));
    transition: opacity var(--opacity-duration) var(--opacity-delay) ease-in-out, transform var(--trans-duration) var(--trans-delay) ease-in-out, visibility var(--opacity-duration) var(--opacity-delay);

    &:hover {
      transition: opacity var(--opacity-duration) var(--opacity-delay) ease-in-out, transform var(--trans-duration) var(--trans-delay) ease-in-out, visibility var(--opacity-duration) var(--opacity-delay);
    }
  }

  &--filtered {
    opacity: 1;
    transform: translateY(var(--filter-offset));
    // animation: backwards;
    transition: transform var(--trans-duration) var(--trans-delay) ease-in-out, opacity var(--opacity-duration) var(--opacity-delay) ease-in-out, stroke 200ms ease-out;


    &:hover {
      transition: transform var(--trans-duration) var(--trans-delay) ease-in-out, opacity var(--opacity-duration) var(--opacity-delay) ease-in-out, stroke 200ms ease-out;
    }

  }


  &--active {

    overflow: visible;

    &::before {
      content: "";
      width: 2rem;
      position: absolute;
      // right: calc(100% + 3px);
      right: calc(100% + 1px);
      top: 0;
      height: 100%;
      background: lime;
    }

  }

  &__tab-button {
    top: 0;
    left: 0;
    position: absolute;
    overflow: hidden;
    width: 100%;
    height: 100%;
    // z-index: -1;
    // z-index: 0;
    // z-index: 200;
    background: transparent;
    touch-action: none;
    transition: box-shadow 100ms ease-in-out;
    // backdrop-filter: var(--backdrop-filter);

    &:focus {
      // box-shadow: inset 0 0 0 2px lime, 0 0 0 2px var(--color-one);
      box-shadow: inset 0 0 0 2px lime;
      transition: box-shadow 100ms ease-in-out;
    }

    // &::before {
    //   content: "";
    //   pointer-events: none;
    //   position: absolute;
    //   top: 0;
    //   left: 0;
    //   width: 100%;
    //   height: 100%;
    //   z-index: -2;
    //   background: transparent;
    //   backdrop-filter: var(--backdrop-filter);
    //   // backdrop-filter: blur(6px);
    // }

    &::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 68rem;
      height: 68rem;
      z-index: -1;
      opacity: 0;
      background: radial-gradient(circle at center, var(--color-two-hover), transparent 50%);
      transform: translate(calc(var(--x-pos) - 50%), calc(var(--y-pos) - 50%));
      // transition: none;
      transition: opacity 100ms ease-out;
    }
  }

  &__checkbox-label {
    position: relative;
    z-index: 1;
    width: 1rem;
    height: 1rem;
    margin-right: var(--greater-padding);
  }

  &__checkbox {
    position: absolute;
    width: 1rem;
    height: 1rem;
    opacity: 0;

    &:focus+svg {
      box-shadow: inset 0 0 0 2px lime;
    }

    &:checked+svg .tab__svg-checkbox-box {
      fill: var(--color-four);
    }

    &:checked+svg .tab__svg-checkbox-checkmark {
      stroke: var(--color-two);
    }
  }

  &__svg-checkbox {
    position: absolute;
    pointer-events: none;
    // border-radius: var(--lesser-padding);
    top: -0.2rem;
    left: -0.2rem;
    transition: box-shadow 20ms ease-in-out;

    &-box {
      fill: transparent;
      transition: fill 20ms ease-in-out;
    }

    &-checkmark {
      stroke: transparent;
      transition: stroke 20ms ease-in-out;
    }
  }

  &__favicon {
    // z-index: 9999;
    border: none;
    width: 20px;
    height: 20px;
    margin-right: var(--greater-padding);
  }

  &__title {
    pointer-events: none;
    user-select: none;
    // z-index: 2;
    position: relative;
    margin: 0 var(--greater-padding) 0 0;
    flex: 1 0 0;
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
  }

  &__close-tab-button {
    position: relative;
    z-index: 1;
    width: 1rem;
    height: 1rem;
    // border-radius: var(--lesser-padding);
    background: transparent;

    &::before {
      content: "";
      position: absolute;
      width: 140%;
      height: 140%;
      top: -0.2rem;
      left: -0.2rem;
      // border-radius: var(--lesser-padding);
      z-index: -1;
      pointer-events: none;
      transition: background-color 120ms ease-out;
    }

    &:focus {
      box-shadow: none;

      &::before {
        box-shadow: inset 0 0 0 2px lime;
        transition: box-shadow 120ms ease-in-out;
      }

    }

    &:hover {
      &::before {
        background: var(--color-two-pressed);
      }
    }

    & img {
      pointer-events: none;
    }

    &:active {
      transform: scale(0.96);
      transition: transform 20ms ease-in-out;
    }
  }

  &--held-down {
    position: relative;
    transform: translateY(var(--filter-offset)) scale(0.99);
    background: transparent;
    transition: transform 60ms ease-out;

    &:hover {
      // background: transparent;
      // transition: transform 138ms ease-out;

      & .tab__tab-button {
        &::after {
          content: "";
          background: transparent;
          transition: none;
        }
      }

    }

    & .tab__tab-button {

      &::before {
        content: "";
        position: absolute;
        width: 680rem;
        height: 680rem;
        top: 0;
        left: 0;
        z-index: -1;
        transform: translate(calc(var(--x-pos) - 50%), calc(var(--y-pos) - 50%)) scale(0.1);
        transition: none;
        background: radial-gradient(circle at center, transparent 0.5%, var(--color-two) 1% 100%);
        animation: 320ms ease-in forwards heldDown;
      }

      &::after {
        content: "";
        background: transparent;
        transition: none;
      }
    }

  }

  &--draggable {
    pointer-events: none;
    animation: 80ms ease-out forwards draggable;
    cursor: grabbing;
    background: transparent;
    // z-index: -1;
    // backdrop-filter: blur(8px);
    // transform: translateY(var(--y-offset));
    transform: translateY(calc(var(--filter-offset) + var(--drag-offset)));
    transition: none;
    box-shadow: none;
    // z-index: 9000;

    &:hover {
      // transition: none;
      // background: transparent;

      & .tab__tab-button {
        &::after {
          content: "";
          background: transparent;
        }
      }
    }

    & .tab__tab-button {
      cursor: grabbing;
      z-index: -1;
      backdrop-filter: blur(6px);

      &:focus {
        box-shadow: inset 0 0 0 2px lime;
        transition: box-shadow 100ms ease-in-out;
      }

      &::after {
        // z-index: -100;
        content: "";
        position: absolute;
        transform: none;
        background: transparent;
      }
    }

  }

  &--banana {
    pointer-events: none;
    opacity: var(--opacity);
    transform: translateY(var(--filter-offset)) scale(var(--scale));
    animation: var(--animation-duration) 138ms ease-in forwards moving;
    transition: transform 100ms ease-in, opacity 100ms ease-in;
    // transition: transform 200ms ease-in, opacity 200ms ease-in;
    z-index: -1;
  }

  &--peach {
    animation: calc(var(--animation-duration) + 100ms) ease-in forwards moving;
  }

  &--floating {
    pointer-events: none;
    opacity: var(--opacity);
    background: var(--color-two-hover);
    // background: purple;
    transform: translateY(calc(var(--filter-offset) + var(--drag-offset))) scale(var(--scale));
    // transform: translateY(calc(var(--drag-offset) + var(--misc-offset))) scale(var(--scale));
    animation: none;
    transition: transform 60ms ease-in-out, opacity 60ms ease-in-out;
    z-index: -1000;
  }

  &__duplicate-indicator {
    margin-right: var(--greater-padding);
    stroke: var(--color-three);
    opacity: 0;
    transition: opacity 200ms ease-out;
  }

  &--duplicate {
    & .tab__duplicate-indicator {
      opacity: 1;
      transition: opacity 200ms ease-out;
    }
  }

  &--deleted {
    opacity: 0;
    transition: opacity 100ms ease-out;

    &:hover {
      opacity: 0;
      transition: opacity 100ms ease-out;
    }

    &~li {
      animation: var(--below-deleted-animation-duration) 100ms ease-in-out forwards belowDeleted;
    }
  }
}

@keyframes belowDeleted {
  from {
    transform: translateY(var(--filter-offset));
  }

  to {
    // transform: translateY(calc(var(--y-offset) - var(--block-height) - var(--lesser-padding)));
    transform: translateY(calc(var(--filter-offset) + var(--deleted-offset)));
  }
}

@keyframes draggable {
  from {
    // transform: translateY(var(--y-offset)) scale(0.99)
    transform: translateY(calc(var(--filter-offset) + var(--drag-offset))) scale(0.99)
  }

  to {
    // transform: translateY(var(--y-offset)) scale(1.01)
    transform: translateY(calc(var(--filter-offset) + var(--drag-offset))) scale(var(--scale))
  }
}

// @keyframes moving {

//   from {
//     transform: translateY(var(--y-offset)) scale(var(--scale));
//   }

//   to {
//     transform: translateY(calc(var(--y-offset) + var(--moved-offset))) scale(var(--scale));
//   }
// }
@keyframes moving {

  0% {
    transform: translateY(var(--filter-offset)) scale(var(--scale));
  }

  to {
    transform: translateY(calc(var(--filter-offset) + var(--moved-offset))) scale(var(--scale));
  }
}


@keyframes returnToNormal {

  from {
    // backdrop-filter: blur(6px);
    // z-index: 1;
    opacity: var(--opacity);
    // transform: translateY(calc(var(--y-offset) + var(--filter-offset))) scale(var(--scale));
    transform: translateY(calc(var(--misc-offset) + var(--filter-offset))) scale(var(--scale));
  }

  to {
    // z-index: 0;
    // backdrop-filter: none;
    opacity: 1;
    transform: translateY(var(--filter-offset)) scale(1);
  }
}

@keyframes heldDown {
  from {
    transform: translate(calc(var(--x-pos) - 50%), calc(var(--y-pos) - 50%)) scale(0.1);
  }

  to {
    transform: translate(calc(var(--x-pos) - 50%), calc(var(--y-pos) - 50%)) scale(15);
  }
}

// @keyframes filteredIn {

//   0% {
//     transform: translateY(var(--y-offset));
//   }

//   100% {
//     transform: translateY(0);
//   }

// }